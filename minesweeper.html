<html>
  <!--=======================================================================-->

  <head>
    <title>Minesweeper</title>
    <script type="text/javascript" src="/epilog/javascript/epilog.js"></script>
    <script
      type="text/javascript"
      src="/worksheets/javascript/worksheets.js"
    ></script>
    <script type="text/javascript">
      function getwritetime(folder, dataset) {
        return localStorage["time"] || 0;
      }

      function getdata(folder, dataset) {
        console.log("getdata");
        console.log(dataset);
        console.log(localStorage[dataset]);
        return readdata(localStorage[dataset]);
      }

      function putdata(folder, dataset, data) {
        console.log("putdata");
        console.log(dataset);
        console.log(grindem(data));
        localStorage[dataset] = grindem(data);
        localStorage["time"] = timestamp();
        return localStorage["time"];
      }
    </script>
  </head>

  <!--=======================================================================-->

  <body
    leftmargin="0"
    topmargin="0"
    marginwidth="0"
    marginheight="0"
    bgcolor="#f4f6f8"
    onload="initialize()"
  >
    <center>
      <table width="640" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td width="640" height="90" align="center">
            <span
              style="
                font-size: 48px;
                color: #000088;
                cursor: pointer;
                width: 100%;
              "
              >Minesweeper</span
            >
          </td>
        </tr>
      </table>
    </center>

    <!--=======================================================================-->

    <center>
      <br />
      <span style="font-size: 18px; color: #666666"
        >Click in a clear square<br />
        to reveal its status.</span
      >
      <table bgcolor="#ffffff" cellspacing="0" border="10">
        <tr>
          <td
            id="mark(1,1)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(1,2)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(1,3)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(1,4)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(1,5)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(1,6)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(1,7)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(1,8)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(1,9)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
        </tr>
        <tr>
          <td
            id="mark(2,1)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(2,2)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(2,3)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(2,4)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(2,5)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(2,6)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(2,7)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(2,8)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(2,9)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
        </tr>
        <tr>
          <td
            id="mark(3,1)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(3,2)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(3,3)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(3,4)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(3,5)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(3,6)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(3,7)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(3,8)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(3,9)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
        </tr>
        <tr>
          <td
            id="mark(4,1)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(4,2)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(4,3)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(4,4)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(4,5)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(4,6)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(4,7)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(4,8)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(4,9)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
        </tr>
        <tr>
          <td
            id="mark(5,1)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(5,2)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(5,3)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(5,4)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(5,5)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(5,6)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(5,7)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(5,8)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(5,9)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
        </tr>
        <tr>
          <td
            id="mark(6,1)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(6,2)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(6,3)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(6,4)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(6,5)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(6,6)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(6,7)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(6,8)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(6,9)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
        </tr>
        <tr>
          <td
            id="mark(7,1)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(7,2)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(7,3)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(7,4)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(7,5)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(7,6)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(7,7)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(7,8)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(7,9)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
        </tr>
        <tr>
          <td
            id="mark(8,1)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(8,2)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(8,3)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(8,4)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(8,5)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(8,6)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(8,7)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(8,8)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(8,9)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
        </tr>
        <tr>
          <td
            id="mark(9,1)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(9,2)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(9,3)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(9,4)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(9,5)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(9,6)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(9,7)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(9,8)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
          <td
            id="mark(9,9)"
            width="60"
            height="60"
            align="center"
            valign="center"
            style="font-family: helvetica; font-size: 28pt; cursor: pointer"
            onclick="modbutton(this)"
          >
            &nbsp;
          </td>
        </tr>
      </table>
    </center>

    <br />
    <br />

    <center>
      <table
        id="rewards"
        width="300"
        style="display: none"
        cellspacing="0"
        cellpadding="4"
        border="1"
      >
        <tr>
          <td
            width="50%"
            align="center"
            style="font-weight: bold"
            bgcolor="#dddddd"
          >
            white
          </td>
          <td
            width="50%"
            align="center"
            style="font-weight: bold"
            bgcolor="#dddddd"
          >
            black
          </td>
        </tr>
        <tr>
          <td id="whitereward" width="50%" align="center">0</td>
          <td id="blackreward" width="50%" align="center">0</td>
        </tr>
      </table>
    </center>

    <!--=======================================================================-->

    <textarea id="lambda" type="text/hrf" style="display: none">
        role(player)

        <!-- columns left to right (M)-->
        file(a)
        file(b)
        file(c)
        file(d)
        file(e)
        file(f)
        file(g)
        file(h)
        file(i)

        <!-- rows bottom to top (N)-->
        rank(1)
        rank(2)
        rank(3)
        rank(4)
        rank(5)
        rank(6)
        rank(7)
        rank(8)
        rank(9)

        succ(1,2)
        succ(2,3)
        succ(3,4)
        succ(4,5)
        succ(5,6)
        succ(6,7)
        succ(7,8)
        succ(8,9)
        succ(a,b)
        succ(b,c)
        succ(c,d)
        succ(d,e)
        succ(e,f)
        succ(f,g)
        succ(g,h)
        succ(h,i)

        <!-- Cell syntax: cell(<column>, <row>, <contents>) -->
        <!-- Possible contents of cell:
            - "mine", "blank" are unclicked, so should be rendered the same
            - numberSurroundingMines for clicked blank, so should render the number
            - "clickedMine" for clicked mine, so should render a mine -->
        <!-- blank cells (all cells with mine cells deleted)-->
        cell(1, 1, mine, u)
cell(1, 2, b, u)
cell(1, 3, b, u)
cell(1, 4, b, u)
cell(1, 5, b, u)
cell(1, 6, b, u)
cell(1, 7, b, u)
cell(1, 8, b, u)
cell(1, 9, b, u)
cell(2, 1, b, u)
cell(2, 2, mine, u)
cell(2, 3, b, u)
cell(2, 4, b, u)
cell(2, 5, b, u)
cell(2, 6, b, u)
cell(2, 7, b, u)
cell(2, 8, b, u)
cell(2, 9, b, u)
cell(3, 1, b, u)
cell(3, 2, b, u)
cell(3, 3, mine, u)
cell(3, 4, b, u)
cell(3, 5, b, u)
cell(3, 6, b, u)
cell(3, 7, b, u)
cell(3, 8, b, u)
cell(3, 9, b, u)
cell(4, 1, b, u)
cell(4, 2, b, u)
cell(4, 3, b, u)
cell(4, 4, mine, u)
cell(4, 5, b, u)
cell(4, 6, b, u)
cell(4, 7, b, u)
cell(4, 8, b, u)
cell(4, 9, b, u)
cell(5, 1, b, u)
cell(5, 2, b, u)
cell(5, 3, b, u)
cell(5, 4, b, u)
cell(5, 5, mine, u)
cell(5, 6, b, u)
cell(5, 7, b, u)
cell(5, 8, b, u)
cell(5, 9, b, u)
cell(6, 1, b, u)
cell(6, 2, b, u)
cell(6, 3, b, u)
cell(6, 4, b, u)
cell(6, 5, b, u)
cell(6, 6, mine, u)
cell(6, 7, b, u)
cell(6, 8, b, u)
cell(6, 9, b, u)
cell(7, 1, b, u)
cell(7, 2, b, u)
cell(7, 3, b, u)
cell(7, 4, b, u)
cell(7, 5, b, u)
cell(7, 6, b, u)
cell(7, 7, mine, u)
cell(7, 8, b, u)
cell(7, 9, b, u)
cell(8, 1, b, u)
cell(8, 2, b, u)
cell(8, 3, b, u)
cell(8, 4, b, u)
cell(8, 5, b, u)
cell(8, 6, b, u)
cell(8, 7, b, u)
cell(8, 8, mine, u)
cell(8, 9, b, u)
cell(9, 1, b, u)
cell(9, 2, b, u)
cell(9, 3, b, u)
cell(9, 4, b, u)
cell(9, 5, b, u)
cell(9, 6, b, u)
cell(9, 7, b, u)
cell(9, 8, b, u)
cell(9, 9, mine, u)




</textarea
    >

    <textarea id="library" type="text/hrf" style="display: none">

<!-- Probably want something like if mine ==> flip game over flag on
    if not mine and not 0 ==> mark as clicked and reveal number
    if not mine and is 0 ==> ??? do the whole big clear thing recursively



    Predicates
    - cell(M, N, mine or blank or revealed value)
    - numberSurroundingMines(M, N)

    Functions
    - clearAdjacent(M, N) :: ???? probably just means you should reveal all adjacent, and recurse on any that are also numberSurroundingMines == 0


-->


click(mark(M,N)) :: cell(M, N, blank) ==> cell(M, N, numberSurroundingMines(M, N)) & ~cell(M, N, blank) & clearAdjacent(M, N)
click(mark(M,N)) :: cell(M, N, mine) ==> exploded & cell(M, N, clickedMine)
<!-- Might also need to reveal all cells during game over? Or maybe that can happen by styling? -->

legal(M,N) :- cell(M,N,blank) or cell(M,N,mine)

terminal :- exploded
terminal :- ~open

goal(player,100) :- ~cell(M, N, blank) & ~exploded
goal(player, 0) :- exploded

open :- cell(M,N,blank)

adjHelper(A, B) :- or(succ(A, B), succ(B, A))
adjacent(M, N, X, Y) :- file(X) & rank(Y) & or(adjHelper(X, M) & adjHelper(Y, N), adjHelper(X, M) & same(Y, N), same(X, M) & adjHelper(Y, N))

numberSurroundingMines(M, N) :- countofall(cell(X, Y, mine), cell(X, Y, mine) & adjacent(M, N, X, Y))

<!-- clearAdjacent pseudocode
    if the selected cell at M, N has 0 surrounding mines:
        for all adjacent cells that are unrevealed:
            reveal it: ~cell(X, Y, blank) & cell(X, Y, numberSurroundingMines(X, Y))
            recursively call clearAdjacent on each adjacent cell (should only propagate to those cells that also have 0 surrounding mines)
 -->
clearAdjacent(M, N) ::
    same(numberSurroundingMines(M, N), 0) & adjacent(M, N, X, Y) & cell(X, Y, blank) ==>
        ~cell(X, Y, blank) & cell(X, Y, numberSurroundingMines(X, Y)) & clearAdjacent(X, Y)


<!-- Not sure what to do here for styling -->
innerhtml(mark(M,N)," ") :- cell(M,N,b)
innerhtml(mark(M,N),W) :- cell(M,N,W) & distinct(W,b)
innerhtml(control,W) :- control(W)
<!-- innerhtml(whitereward,N) :- goal(white,N)
innerhtml(blackreward,N) :- goal(black,N) -->

attribute(mark(M,N),"onclick",true) :- cell(M,N,W) & distinct(W,b)
attribute(mark(M,N),"onclick",true) :- terminal & index(M) & index(N)

style(mark(M,N),"cursor","text") :- cell(M,N,W) & distinct(W,b)
style(mark(M,N),"cursor","text") :- terminal & index(M) & index(N)
style(rewards,"display","") :- terminal

</textarea
    >

    <!--=======================================================================-->
  </body>
</html>
